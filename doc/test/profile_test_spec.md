# プロフィール機能テスト仕様書

## 概要
このテスト仕様書は、IdeaTubeアプリケーションのプロフィール機能に関する単体テストの内容を定義します。

## テスト対象機能
- プロフィール自動作成（PROF-01）
- プロフィール表示（PROF-02）
- プロフィール編集（PROF-03）※未実装
- ユーザー投稿一覧（PROF-04）※未実装

## テスト仕様

### PROF-01: プロフィール自動作成

| テストID | テスト内容 | 入力値 | 期待される結果 | 前提条件 |
|---------|-----------|--------|--------------|---------|
| PROF-01-01 | メールアドレス認証でのプロフィール自動作成 | サインアップフォーム送信 | ユーザーのプロフィールが自動作成され、メールのローカル部分がユーザー名に設定される | - |
| PROF-01-02 | Google認証でのプロフィール自動作成 | Googleログイン | Googleアカウント情報を使用してプロフィールが自動作成される | - |
| PROF-01-03 | 既存メールアドレスのメールローカル部分と同じユーザー名 | サインアップフォーム送信 | 自動的に別のユーザー名（接尾辞付き）が生成される | 既存ユーザーが存在する |
| PROF-01-04 | 特殊文字を含むメールアドレスでのプロフィール作成 | 特殊文字を含むメールでサインアップ | 特殊文字が適切に処理され、有効なユーザー名が生成される | - |
| PROF-01-05 | データベーストリガーによるプロフィール作成 | 認証ユーザー追加 | トリガーが実行され、プロフィールが自動的に作成される | - |

### PROF-02: プロフィール表示

| テストID | テスト内容 | 入力値 | 期待される結果 | 前提条件 |
|---------|-----------|--------|--------------|---------|
| PROF-02-01 | 投稿のユーザープロフィール表示 | 投稿一覧表示 | 各投稿に作成者のユーザー名とアバターが表示される | 投稿のあるチャンネル |
| PROF-02-02 | アバター画像がnullの場合の表示 | 投稿一覧表示 | デフォルトのアバターアイコンが表示される | アバター未設定のユーザーの投稿 |
| PROF-02-03 | 長いユーザー名の表示処理 | 投稿一覧表示 | 長いユーザー名が適切に省略または折り返し表示される | 長いユーザー名のユーザーの投稿 |
| PROF-02-04 | アバター画像の読み込みエラー時の表示 | 無効なアバターURLが設定された投稿表示 | フォールバックアイコンが表示される | 無効なアバターURLのユーザーの投稿 |
| PROF-02-05 | プロフィール情報の表示統一性 | 複数ページ間の移動 | 同一ユーザーのプロフィール情報が一貫して表示される | 複数投稿のあるユーザー |

### PROF-03: プロフィール編集（未実装）

| テストID | テスト内容 | 入力値 | 期待される結果 | 前提条件 |
|---------|-----------|--------|--------------|---------|
| PROF-03-01 | ユーザー名の変更 | 新しいユーザー名入力 | ユーザー名更新成功、表示の更新 | 実装後テスト |
| PROF-03-02 | すでに使用されているユーザー名への変更 | 既存ユーザー名入力 | エラーメッセージ表示 | 実装後テスト |
| PROF-03-03 | 無効なユーザー名形式での変更 | 無効なユーザー名入力 | エラーメッセージ表示 | 実装後テスト |
| PROF-03-04 | アバター画像のアップロード | 有効な画像ファイル選択 | アバター更新成功、表示の更新 | 実装後テスト |
| PROF-03-05 | 無効なアバター画像のアップロード | 無効なファイル選択 | エラーメッセージ表示 | 実装後テスト |
| PROF-03-06 | 他ユーザーのプロフィール編集アクセス | 他ユーザーの編集URL直接アクセス | アクセス拒否、エラーメッセージ表示 | 実装後テスト |

### PROF-04: ユーザー投稿一覧（未実装）

| テストID | テスト内容 | 入力値 | 期待される結果 | 前提条件 |
|---------|-----------|--------|--------------|---------|
| PROF-04-01 | ユーザープロフィールページでの投稿一覧表示 | ユーザー名クリック | ユーザーの投稿一覧表示 | 実装後テスト |
| PROF-04-02 | 投稿のないユーザーの投稿一覧 | 投稿のないユーザーのプロフィールアクセス | 「投稿がありません」メッセージ表示 | 実装後テスト |
| PROF-04-03 | 投稿一覧のソート順 | ユーザープロフィールページアクセス | 作成日時の新しい順に投稿表示 | 実装後テスト |
| PROF-04-04 | ページネーション動作確認 | 「次へ」ボタンクリック | 次のページの投稿表示 | 実装後テスト |
| PROF-04-05 | 異なるチャンネルへの投稿の表示 | ユーザープロフィールページアクセス | チャンネル情報付きで投稿が表示される | 実装後テスト |

## 特記事項
- プロフィール自動作成はデータベーストリガーで実装されている
- ユーザー名は3文字以上の長さが必要
- ユーザー名は一意である必要がある
- OAuth認証（Google認証）では、プロバイダから取得したユーザー情報をプロフィールに使用
- プロフィール編集、ユーザー投稿一覧機能は現在未実装だが、将来の実装に備えてテスト仕様を定義
- アバター画像は最適化のためにWebP形式での保存が推奨される
- 将来的にはユーザーのプライバシー設定（投稿の公開範囲など）も検討すべき 