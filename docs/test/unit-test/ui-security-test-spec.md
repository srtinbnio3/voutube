# UI/UXおよびセキュリティ機能テスト仕様書

## 概要
このテスト仕様書は、IdeaTubeアプリケーションのUI/UXおよびセキュリティ機能に関する単体テストの内容を定義します。

## テスト対象機能

### UI/UX機能
- レスポンシブデザイン（UI-01）
- ダークモード（UI-02）※未実装
- 多言語対応（日本語）（UI-03）
- 多言語対応（英語）（UI-04）
- ローディング表示（UI-05）
- エラー表示（UI-06）

### セキュリティ機能
- HTTPS通信（SEC-01）
- RLSポリシー（SEC-02）
- CSRF保護（SEC-03）
- 入力バリデーション（SEC-04）

## テスト仕様

### UI-01: レスポンシブデザイン

| テストID | テスト内容 | 入力値 | 期待される結果 | 前提条件 |
|---------|-----------|--------|--------------|---------|
| UI-01-01 | モバイル画面サイズでのレイアウト | 画面幅: 375px | モバイル向けレイアウト表示、要素が適切に配置される | - |
| UI-01-02 | タブレット画面サイズでのレイアウト | 画面幅: 768px | タブレット向けレイアウト表示、要素が適切に配置される | - |
| UI-01-03 | デスクトップ画面サイズでのレイアウト | 画面幅: 1440px | デスクトップ向けレイアウト表示、要素が適切に配置される | - |
| UI-01-04 | 画面回転時のレイアウト | デバイス回転（横向き/縦向き） | 回転に応じたレイアウト調整、UIの崩れなし | モバイルまたはタブレット |
| UI-01-05 | ナビゲーション要素のレスポンシブ対応 | 異なる画面サイズ | 画面サイズに応じたナビゲーション表示（ハンバーガーメニューなど） | - |
| UI-01-06 | フォーム要素のレスポンシブ対応 | 異なる画面サイズでフォーム操作 | 画面サイズに応じたフォーム表示と入力のしやすさ | - |
| UI-01-07 | テキストの可読性 | 異なる画面サイズでテキスト表示 | 画面サイズに関わらずテキストが読みやすく表示される | - |

### UI-02: ダークモード（未実装）

| テストID | テスト内容 | 入力値 | 期待される結果 | 前提条件 |
|---------|-----------|--------|--------------|---------|
| UI-02-01 | ダークモード切り替え | ダークモードボタンクリック | テーマが暗色に切り替わる | 実装後テスト |
| UI-02-02 | ライトモード切り替え | ライトモードボタンクリック | テーマが明色に切り替わる | 実装後テスト |
| UI-02-03 | システム設定に基づく自動切り替え | システムカラーテーマ変更 | システム設定に合わせてテーマが切り替わる | 実装後テスト |
| UI-02-04 | ダークモード設定の保存 | ページ更新/再訪問 | 前回選択したテーマ設定が保持される | 実装後テスト |
| UI-02-05 | ダークモード時のコントラスト | ダークモードでのUIチェック | WCAG基準を満たす適切なコントラスト比を維持 | 実装後テスト |

### UI-03: 多言語対応（日本語）

| テストID | テスト内容 | 入力値 | 期待される結果 | 前提条件 |
|---------|-----------|--------|--------------|---------|
| UI-03-01 | 日本語表示の確認（認証画面） | 認証画面アクセス | すべてのテキストが日本語で正しく表示される | - |
| UI-03-02 | 日本語表示の確認（チャンネル一覧） | チャンネル一覧アクセス | すべてのUIテキストが日本語で正しく表示される | - |
| UI-03-03 | 日本語表示の確認（投稿フォーム） | 投稿フォームアクセス | フォームラベル、ボタン等が日本語で正しく表示される | ログイン済みユーザー |
| UI-03-04 | 日本語表示の確認（エラーメッセージ） | エラー発生操作 | エラーメッセージが日本語で正しく表示される | - |
| UI-03-05 | 日本語のフォント表示確認 | 全画面 | 日本語フォントが正しく表示される（文字化けなし） | - |
| UI-03-06 | 長い日本語テキストのレイアウト | 長い日本語テキスト表示 | テキストが適切に折り返され、レイアウトが崩れない | - |

### UI-04: 多言語対応（英語）

| テストID | テスト内容 | 入力値 | 期待される結果 | 前提条件 |
|---------|-----------|--------|--------------|---------|
| UI-04-01 | 英語表示の確認（認証画面） | 英語設定で認証画面アクセス | すべてのテキストが英語で正しく表示される | - |
| UI-04-02 | 英語表示の確認（チャンネル一覧） | 英語設定でチャンネル一覧アクセス | すべてのUIテキストが英語で正しく表示される | - |
| UI-04-03 | 英語表示の確認（投稿フォーム） | 英語設定で投稿フォームアクセス | フォームラベル、ボタン等が英語で正しく表示される | ログイン済みユーザー |
| UI-04-04 | 英語表示の確認（エラーメッセージ） | 英語設定でエラー発生操作 | エラーメッセージが英語で正しく表示される | - |
| UI-04-05 | 言語切り替え機能 | 言語切り替えオプション選択 | インターフェース言語が選択した言語に切り替わる | - |
| UI-04-06 | 言語設定の保持 | ページ更新/再訪問 | 前回選択した言語設定が保持される | - |

### UI-05: ローディング表示

| テストID | テスト内容 | 入力値 | 期待される結果 | 前提条件 |
|---------|-----------|--------|--------------|---------|
| UI-05-01 | データ読み込み中のローディング表示 | チャンネル一覧表示 | データ取得中にローディングインジケータが表示される | - |
| UI-05-02 | フォーム送信中のローディング表示 | フォーム送信 | 送信処理中にボタンがローディング状態に変わる | - |
| UI-05-03 | ページ遷移時のローディング表示 | ページ間の移動 | 遷移中にローディングインジケータが表示される | - |
| UI-05-04 | 長時間読み込み時のフィードバック | 長時間データ取得 | ローディングが続く場合、適切なフィードバックを提供 | ネットワーク遅延状態 |
| UI-05-05 | ローディングキャンセル | キャンセルボタンクリック | 可能な場合、ローディング処理がキャンセルされる | - |

### UI-06: エラー表示

| テストID | テスト内容 | 入力値 | 期待される結果 | 前提条件 |
|---------|-----------|--------|--------------|---------|
| UI-06-01 | フォーム入力エラーの表示 | 無効なフォーム入力 | フィールド近くにエラーメッセージが表示される | - |
| UI-06-02 | API通信エラーの表示 | APIエラー発生操作 | ユーザーフレンドリーなエラー通知が表示される | - |
| UI-06-03 | 404エラーページの表示 | 存在しないURLアクセス | カスタム404ページが表示される | - |
| UI-06-04 | 500エラーページの表示 | サーバーエラー発生 | カスタム500ページが表示される | - |
| UI-06-05 | エラー状態からの回復 | エラー状態でのアクション | 適切な回復手段が提供され、正常状態に戻れる | - |
| UI-06-06 | エラーメッセージの明確さ | エラー発生操作 | エラーの原因と対処方法が明確に説明される | - |

### SEC-01: HTTPS通信

| テストID | テスト内容 | 入力値 | 期待される結果 | 前提条件 |
|---------|-----------|--------|--------------|---------|
| SEC-01-01 | HTTPS接続確認 | アプリケーションアクセス | HTTPS経由でセキュアに接続される | - |
| SEC-01-02 | HTTPからHTTPSへのリダイレクト | HTTP URLアクセス | HTTPS URLに自動的にリダイレクトされる | - |
| SEC-01-03 | SSL証明書の有効性 | アプリケーションアクセス | 有効なSSL証明書が使用され、ブラウザに警告が表示されない | - |
| SEC-01-04 | セキュアクッキー設定 | ログイン操作 | Secure属性付きのクッキーがセットされる | - |
| SEC-01-05 | コンテンツセキュリティポリシー | アプリケーションアクセス | 適切なCSPヘッダーが設定されている | - |

### SEC-02: RLSポリシー

| テストID | テスト内容 | 入力値 | 期待される結果 | 前提条件 |
|---------|-----------|--------|--------------|---------|
| SEC-02-01 | 他ユーザー投票データのアクセス制限 | 他ユーザーの投票データ取得操作 | アクセスが拒否される | ログイン済みユーザー |
| SEC-02-02 | 自分の投票データのアクセス許可 | 自分の投票データ取得操作 | アクセスが許可され、データが取得できる | ログイン済みユーザー |
| SEC-02-03 | 管理者のデータアクセス権限 | 管理者アカウントでデータアクセス | 適切なデータへのアクセスが許可される | 管理者権限 |
| SEC-02-04 | 非ログイン時の保護データアクセス | 保護データアクセス操作 | アクセスが拒否される | 非ログインユーザー |
| SEC-02-05 | RLSの一貫した適用 | 異なるアクセス経路でのデータ取得操作 | すべてのアクセス経路でRLSポリシーが適用される | - |

### SEC-03: CSRF保護

| テストID | テスト内容 | 入力値 | 期待される結果 | 前提条件 |
|---------|-----------|--------|--------------|---------|
| SEC-03-01 | フォーム送信時のCSRFトークン検証 | CSRFトークンなしでフォーム送信 | リクエストが拒否される | - |
| SEC-03-02 | 無効なCSRFトークンでのフォーム送信 | 無効なCSRFトークンでフォーム送信 | リクエストが拒否される | - |
| SEC-03-03 | 有効なCSRFトークンでのフォーム送信 | 有効なCSRFトークンでフォーム送信 | リクエストが正常に処理される | - |
| SEC-03-04 | CSRFトークンの有効期限 | 期限切れトークンでフォーム送信 | リクエストが拒否される | - |
| SEC-03-05 | AJAX操作のCSRF保護 | CSRFトークンなしでAJAXリクエスト | リクエストが拒否される | - |

### SEC-04: 入力バリデーション

| テストID | テスト内容 | 入力値 | 期待される結果 | 前提条件 |
|---------|-----------|--------|--------------|---------|
| SEC-04-01 | SQLインジェクション対策 | SQLインジェクション文字列入力 | 適切にエスケープされ、攻撃が防止される | - |
| SEC-04-02 | XSS攻撃対策 | スクリプトタグを含む入力 | 適切にエスケープされ、スクリプトが実行されない | - |
| SEC-04-03 | HTMLインジェクション対策 | HTML要素を含む入力 | 適切にエスケープまたはサニタイズされる | - |
| SEC-04-04 | サーバーサイドバリデーション | クライアント検証をバイパスした無効な入力 | サーバー側で検証され、エラーが返される | - |
| SEC-04-05 | ファイルアップロードバリデーション | 不正なファイルタイプのアップロード | アップロードが拒否され、エラーメッセージが表示される | - |
| SEC-04-06 | 入力長制限のバリデーション | 制限を超える長さの入力 | 適切なエラーメッセージが表示され、入力が拒否される | - |

## 特記事項
- レスポンシブデザインはモバイルファーストアプローチで実装
- ダークモードは将来実装予定の機能
- 多言語対応は現在、日本語が完全実装され、英語は部分的に実装されている
- セキュリティテストは環境に影響を与えない方法で実施する必要がある
- CSRFテストはテスト環境でのみ実施し、実際のフォームを改ざんしないよう注意
- 入力バリデーションテストはテスト環境でのみ実施し、実際のデータを損なわないよう注意
- HTTPS通信は開発環境では自己署名証明書を使用する場合がある 